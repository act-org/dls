"use strict";(self.webpackChunk_actinc_dls=self.webpackChunk_actinc_dls||[]).push([[1395],{"./src/components/CountyMap/index.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{CustomColor:()=>CustomColor,Default:()=>Default,MultipleSelectedCounties:()=>MultipleSelectedCounties,SelectedCounty:()=>SelectedCounty,__namedExportsOrder:()=>__namedExportsOrder,default:()=>index_stories});var playground=__webpack_require__("./src/helpers/playground.ts"),range=__webpack_require__("./node_modules/d3-array/src/range.js"),quantile=__webpack_require__("./node_modules/d3-scale/src/quantile.js");const defaultData=[{CONVERSION_QUANTITY:547,COUNTY_NAME:"Nassau",FIPS:"36059",QUANTITY:883,STATE_CODE:"NY"},{CONVERSION_QUANTITY:457,COUNTY_NAME:"Suffolk",FIPS:"36103",QUANTITY:761,STATE_CODE:"NY"},{CONVERSION_QUANTITY:301,COUNTY_NAME:"Westchester",FIPS:"36119",QUANTITY:689,STATE_CODE:"NY"},{CONVERSION_QUANTITY:316,COUNTY_NAME:"Bergen",FIPS:"34003",QUANTITY:567,STATE_CODE:"NJ"},{CONVERSION_QUANTITY:281,COUNTY_NAME:"Capitol",FIPS:"09110",QUANTITY:538,STATE_CODE:"CT"},{CONVERSION_QUANTITY:27,COUNTY_NAME:"Bronx",FIPS:"36005",QUANTITY:400,STATE_CODE:"NY"},{CONVERSION_QUANTITY:72,COUNTY_NAME:"Queens",FIPS:"36081",QUANTITY:276,STATE_CODE:"NY"},{CONVERSION_QUANTITY:112,COUNTY_NAME:"Dutchess",FIPS:"36027",QUANTITY:260,STATE_CODE:"NY"},{CONVERSION_QUANTITY:156,COUNTY_NAME:"Monmouth",FIPS:"34025",QUANTITY:258,STATE_CODE:"NJ"},{CONVERSION_QUANTITY:48,COUNTY_NAME:"Kings",FIPS:"36047",QUANTITY:254,STATE_CODE:"NY"}],defaultProcessDataFn=(featureCollection,data)=>{const{features}=featureCollection,scale=(0,quantile.A)().domain(data.map(item=>item.QUANTITY)).range((0,range.A)(10)),mappedFeatures=data.reduce((acc,{COUNTY_NAME,QUANTITY,STATE_CODE})=>(acc[COUNTY_NAME]={quantity:QUANTITY,stateCode:STATE_CODE},acc),{});return{features:features.map(f=>{if(f.properties?.NAME&&mappedFeatures[f.properties.NAME]){const quantity=f.properties?.NAME&&mappedFeatures[f.properties.NAME]?scale(mappedFeatures[f.properties.NAME].quantity):0,properties={...f.properties,quantity,stateCode:mappedFeatures[f.properties.NAME].stateCode,value:f.properties?.NAME&&mappedFeatures[f.properties.NAME]?mappedFeatures[f.properties.NAME].quantity:0};return{...f,properties}}return{...f}}),type:"FeatureCollection"}};var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),useTheme=__webpack_require__("./node_modules/@mui/material/esm/styles/useTheme.js"),esm=__webpack_require__("./node_modules/@turf/bbox/dist/esm/index.js"),isString=__webpack_require__("./node_modules/lodash/isString.js"),isString_default=__webpack_require__.n(isString),numeral=__webpack_require__("./node_modules/numeral/numeral.js"),numeral_default=__webpack_require__.n(numeral),react=__webpack_require__("./node_modules/react/index.js"),react_default=__webpack_require__.n(react),Map=__webpack_require__("./src/components/Map/index.tsx"),MapPopup=__webpack_require__("./src/components/MapPopup/index.tsx");const CountyMap=({data,geoJSONPath,mapboxAccessToken,mapPopupProps,mapProps,onHoverInfo,processDataFn,selectedCounty,setOnHoverInfo,tooltipElement})=>{const{breakpoints,spacing}=(0,useTheme.A)(),[countiesJSON,setCountiesJSON]=react_default().useState(),[hoverInfo,setHoverInfo]=react_default().useState(),finalHoverInfo=onHoverInfo||hoverInfo;react_default().useEffect(()=>{fetch(geoJSONPath).then(resp=>resp.json()).then(json=>setCountiesJSON(json)).catch(err=>console.error("Could not load data",err))},[]);const processedData=react_default().useMemo(()=>countiesJSON&&processDataFn&&processDataFn(countiesJSON,data),[data,countiesJSON,processDataFn]),initialBoundsPosition=react_default().useMemo(()=>{if(selectedCounty&&processedData){const features=processedData.features.filter(d=>selectedCounty.includes(`${d.properties?.STATE}${d.properties?.COUNTY}`));if(features.length>0){const[minLng,minLat,maxLng,maxLat]=(0,esm.A)({features,type:"FeatureCollection"});return{id:features.length>1?void 0:features[0].properties?.GEO_ID,position:[[minLng,minLat],[maxLng,maxLat]]}}}},[processedData,selectedCounty]);if(!processedData)return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{});const parentHeight=mapProps?.height||450,parentWidth=mapProps?.width||"100%";return(0,jsx_runtime.jsx)(Map.A,{data:processedData,height:parentHeight,initialBoundsPosition,mapboxAccessToken,setHoverInfo:setOnHoverInfo||setHoverInfo,sourceId:"county",sourceProps:{promoteId:"GEO_ID",type:"geojson"},width:parentWidth,...mapProps,children:tooltipElement||(finalHoverInfo&&(isString_default()(parentWidth)||parentWidth>breakpoints.values.sm-parseInt(spacing(12),10))?(0,jsx_runtime.jsx)(MapPopup.A,{popupProps:{latitude:finalHoverInfo.lat,longitude:finalHoverInfo.lng},rows:[{title:"County",value:finalHoverInfo.feature.properties?.NAME},{title:"State",value:finalHoverInfo.feature.properties?.stateCode},{title:"FIPS",value:`${finalHoverInfo.feature.properties?.STATE}${finalHoverInfo.feature.properties?.COUNTY}`},{title:"Volume",value:numeral_default()(finalHoverInfo.feature.properties?.value).format("0,0")}],...mapPopupProps}):void 0)})};try{CountyMap.displayName="CountyMap",CountyMap.__docgenInfo={description:"CountyMap component which under the hood uses mapbox and react-map-gl. For this to work it's necessary\nto add the link bellow in the head of your page: <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v2.7.0/mapbox-gl.css' rel='stylesheet' />\nFor more information: https://visgl.github.io/react-map-gl/docs/get-started/get-started#styling",displayName:"CountyMap",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"IMapDataProps[]"}},geoJSONPath:{defaultValue:null,description:"",name:"geoJSONPath",required:!0,type:{name:"string"}},mapboxAccessToken:{defaultValue:null,description:"",name:"mapboxAccessToken",required:!0,type:{name:"string"}},mapPopupProps:{defaultValue:null,description:"",name:"mapPopupProps",required:!1,type:{name:"Partial<MapPopupProps>"}},mapProps:{defaultValue:null,description:"",name:"mapProps",required:!1,type:{name:'Omit<Partial<MapProps>, "mapboxAccessToken">'}},onHoverInfo:{defaultValue:null,description:"",name:"onHoverInfo",required:!1,type:{name:"FeatureHoverProps"}},processDataFn:{defaultValue:null,description:"",name:"processDataFn",required:!1,type:{name:"((featureCollection: FeatureCollection<Geometry, GeoJsonProperties>, data: IMapDataProps[]) => FeatureCollection<Geometry, GeoJsonProperties>)"}},selectedCounty:{defaultValue:null,description:"",name:"selectedCounty",required:!1,type:{name:"string[]"}},setOnHoverInfo:{defaultValue:null,description:"",name:"setOnHoverInfo",required:!1,type:{name:"((newHoverInfo: FeatureHoverProps) => void)"}},tooltipElement:{defaultValue:null,description:"",name:"tooltipElement",required:!1,type:{name:"ReactElement<unknown, string | JSXElementConstructor<any>>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/CountyMap/index.tsx#CountyMap"]={docgenInfo:CountyMap.__docgenInfo,name:"CountyMap",path:"src/components/CountyMap/index.tsx#CountyMap"})}catch(__react_docgen_typescript_loader_error){}const index_stories={args:{data:defaultData,geoJSONPath:"maps/counties.json",mapboxAccessToken:"pk.eyJ1IjoiaXRhZG1pbnMiLCJhIjoiY2wwdmVudmhpMTZvNjNqcG40NXp6Nnk3dCJ9.ThRd0y_bK_8RVfu_zDzTjQ",processDataFn:defaultProcessDataFn},argTypes:(0,playground.Q)({},CountyMap),component:CountyMap,tags:["autodocs"],title:"Molecules / Maps / CountyMap"},Default={},CustomColor={args:{mapProps:{color:"#FF0000"}}},SelectedCounty={args:{data:defaultData,geoJSONPath:"maps/counties.json",processDataFn:defaultProcessDataFn,selectedCounty:["36103"]}},MultipleSelectedCounties={args:{data:defaultData,geoJSONPath:"maps/counties.json",processDataFn:defaultProcessDataFn,selectedCounty:["36103","09001","36027","25025"]}},__namedExportsOrder=["Default","CustomColor","SelectedCounty","MultipleSelectedCounties"];Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"{}",...Default.parameters?.docs?.source}}},CustomColor.parameters={...CustomColor.parameters,docs:{...CustomColor.parameters?.docs,source:{originalSource:"{\n  args: {\n    mapProps: {\n      color: '#FF0000'\n    }\n  }\n}",...CustomColor.parameters?.docs?.source}}},SelectedCounty.parameters={...SelectedCounty.parameters,docs:{...SelectedCounty.parameters?.docs,source:{originalSource:"{\n  args: {\n    data: defaultData,\n    geoJSONPath: 'maps/counties.json',\n    processDataFn: defaultProcessDataFn,\n    selectedCounty: ['36103']\n  }\n}",...SelectedCounty.parameters?.docs?.source}}},MultipleSelectedCounties.parameters={...MultipleSelectedCounties.parameters,docs:{...MultipleSelectedCounties.parameters?.docs,source:{originalSource:"{\n  args: {\n    data: defaultData,\n    geoJSONPath: 'maps/counties.json',\n    processDataFn: defaultProcessDataFn,\n    selectedCounty: ['36103', '09001', '36027', '25025']\n  }\n}",...MultipleSelectedCounties.parameters?.docs?.source}}}}}]);